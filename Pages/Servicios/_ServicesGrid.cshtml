@model List<gestor_eventos.Pages.Servicios.ServiceModel>

@if (Model == null || !Model.Any())
{
    <div class="col-12 text-center py-5">
        <div class="text-muted">
            <i class="bi bi-clipboard-x" style="font-size: 3rem;"></i>
            <h4 class="mt-3">No hay servicios</h4>
            <p>No se encontraron servicios registrados o que coincidan con los filtros aplicados.</p>
            <button type="button" class="btn btn-success mt-2" data-bs-toggle="modal" data-bs-target="#newServiceModal">
                <i class="bi bi-plus-circle me-2"></i> Crear nuevo servicio
            </button>
        </div>
    </div>
}
else
{
    foreach (var service in Model)
    {
        <div class="col-md-4 col-lg-3">
            <div class="card service-card h-100 shadow-sm" 
                 data-service-id="@service.Id" 
                 data-service-name="@service.Name" 
                 data-service-description="@service.Description" 
                 data-service-price="@service.BasePrice" 
                 data-service-eventtype="@service.EventTypes"
                 data-service-images="@string.Join(",", service.Images)">
                
                <!-- Almacenar datos de los items correctamente -->
                <div class="service-items-data d-none" 
                     data-item-ids="@string.Join(",", service.Items.Select(i => i.Id))">
                    @Html.Raw(System.Text.Json.JsonSerializer.Serialize(service.Items))
                </div>
                
                <!-- Resto del contenido de la tarjeta -->
                <div class="card-img-top position-relative" style="height: 180px; overflow: hidden;">
                    <img src="@service.MainImage" class="img-fluid w-100 h-100 object-fit-cover" alt="@service.Name">
                </div>
                <div class="card-body p-3">
                    <h5 class="card-title mb-1 text-truncate">@service.Name</h5>
                    <p class="card-text small text-muted mb-2 text-truncate">@service.Description</p>
                </div>
                <div class="card-footer bg-white p-3 d-flex justify-content-between align-items-center">
                    <span class="fw-bold text-primary">@service.BasePrice.ToString("C")</span>
                    <div class="btn-group">
                        <button class="btn btn-sm btn-outline-primary view-service-btn">
                            <i class="bi bi-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-secondary edit-service-btn">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger delete-service-btn">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="position-absolute top-0 end-0 p-2">
                    <span class="badge bg-primary rounded-pill">
                        @service.EventTypes
                    </span>
                </div>
                <div class="position-absolute top-0 start-0 p-2">
                    <span class="badge bg-secondary rounded-pill">
                        <i class="bi bi-box-seam me-1"></i>@service.TotalItems
                    </span>
                </div>
            </div>
        </div>
    }
}